what's up guys this is Ronnie welcome back to our Channel Total technology Zone and today's topic will be how to build an multimodal splitting uh logic using L chain and open AI Vision okay so this is actually not the uh final part of this tutorial so let me give you a background so basically I'm trying to actually build an uh multimodal rag application with the help of open a vision and Lang CH okay so just to actually create that app I'm actually trying to actually give you guys kind of a background how to actually working on on on on the multimodel application okay so first thing first what is multimodel application I will explain that and after that we'll be going to do the other stuff okay so let me go ahead with the slide so what is multimodel so basically multimodel means actually uh we'll be going to work on something where we are not only considering the text we are also going to considering the image okay so basically uh I'll be going to use a PDF and I'll be going to uh load the PDF first and after that I'll try to actually extract the text and also extract the table and extract the images from the PDF and after that we'll try to do some sort of like question answering that is our ultimate objective but in this tutorial I'm just going to extract the images and I'll explain you guys how to do that and after extracting the images I'll try to actually ask the open llm uh to give me the summary of every image okay and for that reason I'll be going to use open a uh Vision uh like model OKAY Vision preview model okay so once we are done with this thing I'll try to actually conclude the video here but in the next tutorial I'll be going to create a open uh sorry I'll be going to create a multimodal rack application so what will happen I will have a PDF uh I'll first load the PDF and after that I try to ask some question so when the LM is actually going to generate the answer it will give the text based answer and as well as it will try to find out some example images from the PDF if it is able to find that it will give the answer so text and image both will be going to be written from the model and for that reason I'll be going to use the open AI Vision uh uh model and just because we are working on the text and image both that is why this is being called as U multimodal okay so let's uh go ahead with the uh next slide so basically U what are the things actually we'll be going to do so load PDF with images and summarize the information from the images available in the PDF so that is what we're actually trying to do okay so first we'll load the PDF and then we'll be going to load the images from the PDF and after that we'll be going to extract the information from the PDF so this is the ultimate objective okay so now let's minimize this slide and let's close this thing so this is the PDF so if you see these are the some cooking items are available here so I'll be going to load the PDF and try to extract the images okay so I don't know from where actually I downloaded this things so but I saw this is something from Stanford healthcare for Central and South Indian okay okay let's close this thing so we'll start working on that okay okay so first thing we'll be going to actually um in import a library called unstructured okay so that will actually help us to uh load the PDF okay so let's do it so from typing import any right so this is actually going to be little bit uh big tutorial uh like lengthy tutorial try to actually do it very fast okay so for model validation I'll just going to import pantic okay okay import okay then um unstructured uh I think unstructured it will be unstructured so maybe I can just write structured do partition okay dot PDF okay so inut partition PDF import partition PDF okay next thing uh from Lang chain okay so this Lang chain part I'll be going to do it later first let's try to actually import all these things okay so first load the file okay so basically what will have uh load the environment okay import Lo all environment variables are loaded now what we'll do we'll try to actually I'll start a little bit down okay from here so basically we'll create something called U raw this is going to be raw PDF right just just the raw PDF so you can just write raw element so I can just write raw PDF element RP raw PDF element is actually going to be a partition PDF and inside that I'll be just going to pass the file name okay so it should be file name should be sample do PDF right it's done then what will happen uh we'll be going to format with the embed embedded image blocks we'll be going to use PDF format to the embedding image block so basically uh we'll be going to use um uh something like extract extract images in p PDF I'll make it true okay so whatever images are embedded I'll be just going to capture that okay then what you'll do uh I'll be going to use uh layout model YOLO X to get the bounding boxes for the tables okay so for that reason what is actually going to happen so we'll be going to write infer table structure right and that is going to be true as well okay this is done and then we'll be going to actually uh create a chunking strategy chunking strategy is actually going to be titled so basically title means every paragraph like or whatever is there it is trying to look for a subtitle subtitle means it's actually subhe header or heading based on that it will try to actually chunk that okay so let's do that uh chuning strategy is going to be D L I think I should go down here because this is kind of a little bit lengthy here right chunking strategy is done then basically what we'll do we'll try to actually uh to create new chunk based on the 3 8,000 character and attempted to uh keep chunks uh like it greater than 200 character so basically what is actually going to happen so just hold on uh let me actually uh like Max why this is not coming strange Max characters is actually going to be 4,000 and then uh new underscore after this this is actually I'm doing as for the documentation I don't remember anything okay if you do recursive character text splitter there actually we have uh chunk uh chunk size and chunk over left so this is actually similar to that okay I think it should be 308 okay I think that is done now what will happen this should be combine uh text uh text under here it should be 2,000 okay so let's execute this thing first whether I'm getting any error or not let's check it so the file is actually having 170 pages so this will take some time let's wait okay it's working so let's see so in this tutorial I'm just going to load the PDF and after that I'll be just going to extract the images and after that I'll just going to extract the information out of the images right and in the next tutorial I'll be going to do the same tutorial but after extracting the images table and text information I'll try to actually index and create index and vectorize all the information and going to save inside a vector a vector database and after that I'll be just going to do the rag means uh like retrieval and response okay so if I do this two things together in one single tutorial it will be kind of very lendy right and also this the first time we working on the multimodal application so I thought of actually creating this thing at the beginning with this uh like kind of a sub tutorial sub part of the tutorial or maybe kind of a introduction to multimodel and after that I'll be just going to extend this knowledge by creating the rag application I think something is coming so basically Ally uh it started reading and it is going to actually create the bounding box and images everything okay trying to extract so hopefully what will happen here actually one folder will be created inside that all the images will be stored so let's see this still working yeah I think it's done if you see here there's a folder created figure but nothing is there it's still blank okay so extraction is not started yet yeah it's done so let's see how many figures are there so see like this everything is created okay all images are here actually okay I believe total 32 how many image multiple images are there actually okay okay so now what will happen we'll try to actually extract the information from this images okay okay so for that what is actually going to happen so we we got this image now we'll be going to actually uh uh require the information out of this image right so let's see let's try to do the second part so for that reason we need to actually import couple of modules okay related to Lang chain and everything so first I'm going to import let's say import IO import glob and import OS so these are the module let me actually import okay so now what will happen so from blank chain dot check models import in chat models I think it will be chat open right so chat what happened I don't know L chore chat models why is not strange L chain check models uh I don't know what is this let execute this thing one more time uh it is saying that what is the same okay L dication chat model dicated is saying that chat model is get it when this happen Okay L chain replication from L ch so it is saying some warning that Lang chain is deprecated so maybe I need to import something else okay so yeah so just hold on I think lanch has updated their Li from L chain if this uh from langore Community chat model linore right okay I don't think so this is required any more okay so what else we can do uh uh let's see this is something new uh chat model than schema messages so maybe from lank chain do schema uh Leng DOA do messages human message right so this is done what else I'm just thinking uh for to import this one as well so from till below we'll be going to inut library import image okay and going to inut 64 okay I think that's it so first thing first we'll be going to actually create our llm so llm is actually chat open AI right so just because we'll be going to actually uh deete the vision model so I'll be just going to write model equals to GTP i 4 I Vis and TV okay okay right now one by one we'll be going to actually start working on this thing so first thing first uh let me actually uh create this one a file actually and function here okay so this uh what function are we going to create let's so a function which is going to be called for all this file one by one and it is going to generate the summary okay so let's see we'll be going to create the function so basically so to match 2 this 64 so here I'll be just going to get the image path right and let's try to working on the function so first of all we'll be going to get a uh path and after that what will happen we'll be going to open the image right so with um with uh image Dot open so basically open so we'll be going to image open the image is image path right and we'll be going to just give a name uh what name is actually going to be as image right like this and after that what will happen we'll be going to save the image right so basically let's create a b okay it should be IO Dot by its IO okay right then we'll be going to save the image uh in the in the in the in the buard format right so basically image dot save okay and what is actually going to be inside this function we'll be going to save the image with this function but inside that we'll be going to pass the buffard format right so basically uh it should be buffer and then what is actually going to happen we going to write down the format the format will be image format Right image dot format so image is actually saved here at this part now we're going to convert that into a base 64 encoding okay maybe just write IM 64 image string I actually which should be the Bas 64 do encode right uh basically it should be b64 encode right the 64 encode and what is exactly going to be encode uh we'll be going to actually uh get the buffer uh get value so basically it should be buffer do get value then like this okay now we'll be going to pass this image here right so we be going to just pass the image string nothing else right and it will be the decoded format so IM string dot decode and the decoders are actually going to happen in the UPF 8 okay so UTF I 8 so this is a little bit tricky but this is how we can actually pass this image now to into an llm okay so up to this part everything is done now what will happen we will be going to just call this function okay so uh llm is actually here we need to create uh we need to actually create uh something called uh what you call like um I'm just thinking screen actually is going to be we'll be going to pass this in a stream basically Okay so but is there and the stream is actually going to come so basically the CH window great just thinking let's open so basically uh yes fine okay so what will happen so basically I'll be going to actually create the uh set the current working directory is actually this directory because all files are here so I'll just go and copy path and I'll just paste it here okay right now the files how many files are there so it should be glob do glob okay then current working directory like this then this then probably I can this okay okay and then star. jpg okay and then what we'll do we just write for file in files right and then we can simply write print file right okay so what will happen uh let me actually uh close this part because this part has nothing to do with right now so okay so basically I can simply comment this to line so basically I just want to print out the lines I mean the files because I'm just going to read it from here okay so let's do it and we'll see whether it is able to generate all the file or not yeah it's able to generate all the files so no problem in that so now the looping is actually going to happen here so basically uh we'll try now okay okay so this is is done then what will happen uh we'll be going to actually uh call there is something called is is actually going to be this function I'll be going to call and here we just going to call the file so every time this file is actually going to be called so image string okay so maybe I can just write image okay right so this function is actually getting called the moment this function is getting call then we'll be going to get some information so basically this chat so I'll be going to create uh a chat and here I'll be just going to write some information so chat open AI right so basically first um our llm is actually at the top we declare our llm right or not let me check whether I declare our LM or not uh okay yeah I decare our llm but I don't think so it is required so basically uh I think okay so basically just hold on I'm just checking couple of things here okay so basically I think it is not required here so I'll just write this here okay so we try to actually run this this and maybe maxcore let's try to do it so I don't think it is required anymore okay so what I'll do I'll just going to write this LM here and I'll just going to cut this thing from here to here because I can declare only one time right and now what will happen uh right so basically I can just create response equals to uh response equals to llm dot invoke like this okay then what will happen like this okay so for first thing simply write human message so in the human message I'll be just going to write write a Content okay like this and here what will be the content okay so content will be again a list okay like this okay so inside the list what we will write so we'll be going to pass a dictionary first okay so first thing first we'll be going to write type like this and the type will be actually a text okay right and the message will be what right and and the text message will be what so uh please give a summary of the image provide the this and SM okay this is done right so I can start this thing here like this and it will be closed here like this and after the comma and this okay then the next thing we'll be going to pass the image URL right so same thing okay typ like this okay and then okay like this okay so inside image URL we'll be going to pass something so let's say so we'll have URL okay like this okay and what is exactly the URL so the in the URL we will have the data image and we'll be going to pass um like in this format so the F string format okay so F string when double codes then we'll be going to write data then col image right and then we be going to like this right and then we'll be going to write JP jpj I believe right uh let's say jpeg okay then it should be P 64 then comma and then this thing inside that I'll be just going to write image string I believe all done now uh everything is done here so now what will happen now one by one we need to actually close so basically this is going to be a comma here right then I believe I need to put a comma here then this bracket then this then this okay and at blend this I think all completed here no problem at all so let's try to execute this thing at least and see whether it is actually Genera in something or not okay so let's see and at the end uh this was called Loop so you can simply write print uh response do content okay so let's see I'm not executing this thing right now because it is going to take some time but I'm just taking this thing here so this is kind of become a persistent stone for us but again this is not the persistent vector store so that will be discussed in the next tutorial okay so let's start working okay so it is saying that install langen because langen this things are not available okay let's see yeah so it is already started giving me the summary okay it's giving the summary okay I believe it's doing okay so let it run mhm mhm so let keep on giving me all the information okay so from the PDS okay so this is the external information right so now we can easily augment this knowledge to the llm but this time I'm not going to actually uh only looking for the text information I'll be going to use some sort of image as well with the text right so that will be done in the next tutorial probably I'll try to create a stream Le application and the the rest API using python class for fast API and from that I'll be going to actually start doing the development okay so that Tut also going to be very exciting one okay so there too many images are there so that is is time right so let it run for okay so it's still going on okay okay so it's doing it is doing the job H I think it has made many images are there so for all images is actually just trying to capture this thing okay so I don't know how much time this will take maybe 10 minutes more okay so let's see good I think few modes are pending actually which image actually St to started capturing 1948 okay let's see think maybe two three more minutes are pending okay so yeah I don't know like uh I am not uh disconnecting or I'm not stopping the recording I'm not stopping the recording but uh I don't know like how you guys will feel it because this is kind of very boring for most of you as you see it is generating the information on a fly so yeah definitely this is going to take some time right one thing I could do like uh like name of all the images if I can print so that is actually going to use a lot of benefit yep if you see it is giving this something some menu as well like some bpes as well yeah there are total 101 images are there so this is going to read one by one and generating okay okay so what I'll do I'm just going to stop it here because this is going to take a lot of time okay so so guys uh what I did here actually so I had to actually stop the execution because it is keep on doing it and this is going to take a lot of time but um this will actually going to do the thing so what I'll do I'll just try to actually import the model uh if three install lank CH i a okay so just e write mcore open CH open okay and then what we'll do we just try to uncom this two lines okay so guys I think our tutorial is ready so what I'll do I'll just go ahead and delete this thing here okay and I can simply write this thing like this print um what I can just write image is dot split split will be placed on this and the last one is actually the one okay so I can simply write that and after that I can just add this so this will tell me for which file I'm actually doing this okay so something like that okay so let's execute this thing one time and after that I'll just going to close the tutorial and I'll update you guys with the findings okay so let's do it there should not be any error because it is the same code so yep this will run so that is how you can actually extract your images from a p and after that you can run a query to get the information or summarize all the images okay so started already yes okay so I think my images that are generated here so now it is going to start working on this thing so if you see here uh I don't know what is this ah I did a mistake actually I'm calling this image string here okay I'm calling this image string here but actually I have to call this image path oh this thing sorry I have to call this file here so then only it is going to give me the file name sorry actually guys so I should not do it so let let me remove this one here okay so it should be F okay so just do it whenever you guys get some time just try to actually change this code accordingly okay so I'm not going to actually continue the execution for this is going to take some time right what I will do uh I will try to actually just uh end the tutorial here or conclude the tutorial here maybe uh you guys can actually try to run the code U with a different PDF or else you can actually use the same PDF but again if you're uh the if the PDF is actually having more than like 50 Pages or 100 Pages depending on the page count maybe the execution will take a little bit longer for example for my case I think my PDF is actually little bit longer and I have multiple images uh embedded with the PDF so that is why it is taking like that much of time okay okay so actually there is some error actually I got you uploaded an UNS supported image so P pleas make sure image is format J G so basically it is saying that I got a invalid file okay I don't know why it is coming but uh sometimes you get some error okay so maybe I can just do and I can try this thing right all my images are actually J let's run this thing one more time okay so this is going to take another five minutes okay so mean I can delete this directory is going to create the new directory it is still reading the PDF it is going to give do some Waring or some status messages that time the directory is getting generated yeah now actually it is started like extracting the images but not completely uh completed the task as the folder is not created the moment folder is created you can be sure that all thees are available okay so let's wait for one minute okay yeah so you see it's here all created right okay if it started working and I believe this is kind of yes it's kind of giving me the fin name message fin name message okay so what I'll do I'm just going to uh stop this tutorial here guys okay so you guys can uh try to complete the execution and let me know the feedback if you guys are facing any error or something like uh similar just let me know okay so that's it guys uh we'll uh we'll see you uh in the next video and in that next video I'll try to create the multimod rag application and I'll try to uh uh I try to actually um use some of the coding part from this tutorial so I'll request you guys to actually complete this tutorial and try to actually practice The Code by your own because ultimately the coding is important if you do not do your coding by your own you will never get uh like any sort of confidence or motivation to actually do something like better in the future but see I'm actually giving you just a simple l case you can actually extend this use Case by applying your own BL right the more practice you do it will help you to actually evolve around the technology and that will actually help you to build something different and from that actually you can uh do better or you can become expert right so try to actually do the coding orse you will eventually forget because watching videos are not going to help you only watching videos are not going to help okay so last but not least guys please uh if someone is very new to our Channel Channel Try to subscribe to our Channel hit the like but button and also hit the Bell icon so you should not get any notification from the future updates and try to share our videos with your family and friends whoever you think will get some benefit out of it and also it's a it's it's a thumbil request try to subscribe to our Channel we'd like to actually reach larger audien because larger audiences actually will help you to grow and will help us to actually cre the Google appable to promote uh directly organically within the Google algorithm we would like to actually reach larger audience place and for that reason it's my humble request try to subscribe to our Channel and whoever is um watching this video for the first time please try to watch the playlist from the beginning and also try to subscribe to our Channel okay so enough of talking guys I thought this Tut could take only 20 minutes but I believe it took almost one an hour and yep that's life okay we'll see you in the next video I'm concluding the video here we'll see in the next video till then take care goodby and have a nice day and happy Lear