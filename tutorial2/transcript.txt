up guys this is Ronnie welcome back to our Channel Total technology Zone this is tutorial 46 and today's topic will be how to chat with your data breaks table using Lang chain and open AI okay so probably this is the third time I'm actually doing the similar sort of tutorial before that I already did a tutorial where actually I talk about how to chat with your SQL database and after that I did the same thing with mongod DV and this time I'll be going to do similar thing but this time our table is hosted actually on a data breakes cluster okay so what I do uh let me actually show you what exactly you want to do here so work through of the environment and the little bit of coding okay this is going to be a very uh like U uh very short video but a very effective one okay so what it do so let's see so basically if you see here I have already created a uh datab breaks uh uh workspace inside Azure okay so this is my Azure datab workspace name and we can launch workspace from here so basically I just launch the workspace from here okay so this is going to be logged in in couple of minute time okay so the watchs space has been launched okay so now basically couple of thing so after you launch your works sprep from the Azure you have to actually create a compute means the cluster inside where actually you'll be going to do all the compute things so basically I already created a cluster with this name and here couple of things um I'm actually uh setting up an open API key with this thing so basically you have to set the API key here in the environment variable don't worry about this key after some time I'll be going to delete this thing okay so how to create the cluster basically you have to go here and you have to click on create Computing and this will actually uh launch something like this and there you have to go to the Advance section and you have to actually put this thing okay this is first thing and then once this is launched then you have to click on libraries and then you have to install all these libraries like if you click on install new you have to select on pii and you have to just name the packages name and after that you have to click on install so basically there are a couple of things uh not couple of things four five different things I have installed data Bri SQL connector lch langin open langin experimental python. in when uh typing extension so basically not everything is required here but I'll be going to do some more tutorials because of that I'm actually doing it so you can actually just start with this langen langen open and langen experimental and try to actually run this code it will work but if you have I'll be going to do something with other tutorial as well because of that actually I did this thing so once this things are done you have to go to your workspace and inside that I created a folder and inside the folder I'll be just going to create a notepad and from here I'll be going to start working on my code right now what I said I'll be going to actually chat with my data briak table so inside data bricks where the tables are resided so tables are actually resding in this catalog so basically how to open this things I'll just right click and duplicate this tab okay let this tab open here okay now what I'll do I'll be going to click on catalog and inside catalog you can actually create your table but what I did here actually I actually click on Sample and inside that I have a so basically this is called uh this is called uh catalog and this is called schema so inside the schema you have multiple tables I have actually something called trips table so I'll be going to work with the trips table so basically trip tables are actually this many columns and if you click on the sample data it is saying you like a trip start date trip Ed trip distance tip fa amount pick up zip and like drop off zip so this is something some sample table I'll be actually going to actually show you guys how to actually chat with this table from your data brakes cluster okay so how to chat with your data brakes uh table from datab briak cluster using Lang chain and OPI so this is the ultimate thing okay so this is going to be a very fun part because I requested couple of um I got some request uh from couple of students basically so that is why I'm actually doing this tutorial so as I told you guys with the Lang chain I'll try to actually touch base upon each and every small components wherever actually it is useful okay so this is the only tutorial available in the YouTube where someone is actually uh covering all the small and very minute details with Lang chain I try to actually always keep the things very uh like use case driven so that uh it is not going to give you guys only the theoretical part I try to uh like reduce the theory but rather than I just try to actually make something useful by giving you guys some sort of context and some use case Okay so enough of talking so let's go here so first thing first I have to actually import couple of libraries so it should be from lank chain experimental okay then uh Lang spin Elemental agents right then dot uh then it should be D and toolkits right and then import can create uh spark think it should be create spark data frame agent okay so let's see whether it is giving any error or not so no eror is given so intelligence is actually not working so next thing is actually so from Lang chain and then underscore probably open AI then chat open right and then from Bice spark Bice spark is actually uh so basically in datax cluster we have to use we can we must use spy spark basically we'll be going to use the feature of underlying spark because spark actually helps us to actually do uh parallel processing and if you use spark our processing will be very fast because our data is actually coming from the large uh table large database cluster table okay so in that sense you will understand it's going to it's going to be very fast but I'm not going to like deal with the spark internal Theory and this things but just imagine that spark is going to be kind of a framework and where actually the processing is actually very fast okay so P spark do SQL and we have to import the spark session right so basically I don't know why yeah the intelligence is actually now coming so let's execute this thing okay everything is fine so now what we'll do we'll be just going to create a spark session with a variable called spark so basically we'll be going to write SAR session do Builder and there we'll be going to write something called get or create and I'll just write like Lang CH okay okay so this is done and then what it is going to happen so basically Ste okay I don't know uh what is this okay so I think uh it's not required yes okay I understand now so it should be small B now this will work okay that's it now what we do you'll be going to create the data frame so data frame will be coming from that table right from this table so what you'll do it should be spark do SQL right now we'll be going to write the SQL query so basically what is SQL query select all know right select star from and what will be going to happen we'll be just going to write down the table name right copy and we'll be going to just write down the table name and once this thing is done we'll be just going to display some R exactly like f data frame okay so this is now it is done so basically see the spark job and you see total 61 jobs executed in couple of seconds see right okay so you see it is coming now our our things are done now it will be going to happen we'll be going to create an agent okay as I told it is going to be very fast okay and and if you want to check how many rows are there so you can just write DF count right okay 21,000 records are there so now what we be just going to create an agent right agent equals to what agent equals to create spark data frame agent right and we'll be going to pass something called llm right so before we do llm what we'll do uh llm equals to uh what is this chat open AI right so first thing will be model will be GPT 5 and 4 and we'll be going to write temperature is zero right so basically llm equals to llm right and data frame we have to pass the data frame is actually going to be DF so it's a data frame agent right just like and then veros equals to True everything is said here now right so let's do right done now I'll be going to ask some question now so our main task is started so agent. run and there probably I'll be going to write uh what are the columns available right so starting from very basic thing so let's see so it started the veros mode and it is saying this many columns are available see pick up date drop up date trip distance fair amount pick up G drop up G right so now let's ask couple of like some more tricky question right so agent run okay what is the maximum trip distance right so I'll be going to ask total five question okay so let's see yeah see it is doing everything fine right now next question we'll be going to ask agent so don't worry guys about don't worry guys I'll be going to upload this uh notebook uh to my GitHub repository so that you guys can use it okay so uh which what is St or which this Z code has maximum number of pickup okay so with jip code has maximum number of pickup so let's see whether it is able to do it or not okay started see it's doing very fast okay pick up G and it's calculating so there are total 1227 so this is the Gip so now what you'll do we'll be going to just uh change this thing so what I'll do I'll just going to copy this thing copy and drop off okay so total fourth question this is okay right same drop is also same now I'll be going to ask sorry I did something wrong okay so which dat has maximum number of pickup okay MH so in this state has maximum number of pickup total three so basically uh let's see maximum number of drop which date so basically the date is actually U 20161 05 let's see okay so let's see okay so maximum number of drop is actually this thing so maybe some of the drops are actually after 12 hour okay so last question okay uh maybe I just copy this thing and ask this last question so okay what is the maximum Fair among all lips maximum Fair considering all trips let's see how it is now going to calculate huh so it's doing correctly okay so that's it guys this is very like interesting though it's a very small tutorial but how we are going to do that is actually going to be very tricky because um the data Engineers are actually sending me a lot of question that they are building some cluster or they have some cluster data and that data cannot be processed using normal SQL they must use like spark and how to actually use spark and lengthen together so this is the tutorial guys you requested I send you and you see I complete the tutorial basically I completed the tutorial in within I think less than 15 minutes so hopefully you guys will enjoy it and also you'll be able to actually gain some knowledge okay so I'll be just going to conclude the video over here but before I conclude i' be like to uh uh request you something that is from my personal uh that is actually my personal request guys please uh try to subscribe to our Channel if you really enjoy our video and if you came to our channel for the first time or watching our videos for the first time please try to watch our videos from the beginning you can search with langen playlist in our Channel and you will find there are total uh 46 videos are uploaded I believe this is the 46th video so you can actually start watching from the beginning and this will definitely help you to actually Master this Lang chain and LM D application development and last but not least um if you have anything or if you really enjoying our video just try to actually let us know have some sort of feedback good or bad doesn't matter but please try to put put some honest feedback so that we can also work on our quality and we can come back again with uh some uh better content for future right and if you really think these videos are helping you or helping you to do some of your job effectively or if it's helping you to actually do better in your like study or whatever you are doing right so if you think it is helping you in any aspect of your life then please try to let us know by some sort of acknowledgement because that will help us to actually uh get discovered by YouTube actually because the more engagement will actually help YouTube to understand this video is valuable and they will start promoting our videos and eventually we'll actually gain larger audience base right so uh with your help we can actually large uh get some some big achievements in our life so it's a humble request guys please try to subscribe our Channel share our videos with your family and friend and whenever possible if you really enjoying your video just um provide some so that it will motivate us to come back with better and best content for the Future Okay so with that note I'd like to conclude the video over here we'll see you in the next video till then take care goodbye and have a nice day