what's up guys this is Ronnie welcome back to our Channel Total technology Zone this is tutorial 94 and today's topic will be how to chat and plot with your Excel file using Lang chain and gp4 om model okay so basically I'll be going to develop one streamlit application from that application you will be able to upload your Excel file then uh with the help of lank chain and gp4 Omni model you will be able to actually chat with your Excel file and you you can get the answer or response in the text format and also if you want to actually uh generate or plot some chart we have to just uh give uh the instruction and it will follow the instruction and it will generate the plot so basically it is going to be a complete uh complete application like uh chatting and plotting okay so maybe in earlier tutorials I saw that um the that only chatting is possible but I believe I didn't find any tutorial which is actually uh giving you this complete endn approach so that is why I come up with this approach okay so this is going to be very uh interesting one try to watch the video till end and if you like my videos and if you are like new uh audience from to our Channel Try to subscribe to our Channel as well and and try to share our videos with your family and friend okay so with that note let me start working on the actual part so what we going to do here right so first of all we'll develop one streamlet application to upload and read the Excel file right then we'll be going to convert um that Excel file into uh smart data frame right with the help of pandas AI so basically Panda AI is a third part utility what um is uh that is actually the main U like um requirement or prerequisite for this tutorial so basically we'll be going to convert that uh Excel into smart data frame with the help of pandas Ai and lch and openi llm so these two things are required lch and openi llm you already know we have used multiple times so this is a new thing pandas AI I'll be going to use it here so uh we'll be going to convert that Excel file into a smart data frame and that will be uh that will be done with the help of pandas Ai and lanen open llm right once that smart data frame is available we can easily chat and plot by asking some question right and now what is pandas a data frame so basically you can get the information from this link uh this is the link so here so everything is available here if you want to actually read through their documents and guideline you can do it so basically I came across this thing uh uh like one year ago okay but that time I haven't started this L chain tutorial and that time their um their module was not like very much competent or compliance with the Lang CH because yeah text text formats are actually working but plotting was not uh like working that time so that is why like I didn't use that but right now like in last four five months I'm using this library and it is actually working with the Lang chain open llm very smoothly okay so thought of using it okay so let's see so yeah source code is always available here right in this link so without wasting further let me start working working on my coding part okay so what what Excel file I'll be going to upload so basically if I go here in the desktop if you see I have Excel file here trending footall player. XLS so this is the file so it has it has player name images age uh national team position overall like score so basically it is from the some game actually yes Sports FIFA 2024 game actually stats I got this data set from the Kagel current Club current contract value wages total stat so some things are there right so I'll be going to work uh with this Excel file okay and I believe this Excel has how many rows are there maybe 3,000 or something yes so it is going to be like very good entry point to start okay so I'll be going to upload this Excel file in the stimulate okay let's start working on the coding part okay okay so let me start so let's make it a little bit bigger okay so first of all it will be stream lead import stream lead as St so that is the main important thing import stream le as St right okay so first we'll be going to create a stream L UI and that UI is actually going to um help me to upload the file so that is why the first entry point will be our streami right so then uh what we'll be going to be uh what we'll do uh we'll be going to actually create st. tile st. title right going to give a name to this so st. title will be chat with your Excel file right done then it is going to be file so file is going to be std. file uploader and there will'll be going to write upload your upload your file right and the type I'll be going to mention it is going to be XLS X right so that is the file type XLS X okay once this is done we will be going to convert that into a normal data FR and after that we'll be going to uh use it um convert that into a pandas data right so let's see but before doing that um couple of more things will be required so basically if file means if file is available so so then what we'll be going to do uh what we'll be going to do it will be PD so PD means pandas data frame so what we will do now one by one I'll be going to import all the necessary lines import pandas as pandas okay import pandas as sorry something I don't know pandas as PD right so it is going to be PD do read Excel right and inside that I'll be just going to pass this file okay right it is done now what is actually going to happen now we'll be going to convert that into a smart data frame so for doing the smart data frame we'll be going to import the pandas AI module so basically from pandas AI so you have to install it pandas pip 3 install pandas AI remember import smart data frame so I believe uh yeah smart data frame okay done so now it will happen we'll be going to create SDF smart data frame right so SDF will be smart data frame and it is going to take a couple of parameter here right this okay and let's see what are the things it is going to accept so it is going to accept a data frame so my data frame is actually going to be DF right right DF then comma and then what is actually going to do we'll be going to pass a config right so config config config okay so config is actually a dictionary so in the first will be in the dictionary will be uh llm right llm so what will be our llm so we need to actually uh use the langin module so from uh langen open import import chat open right and let's set the llm here llm okay llm equals to chat open a right and my model is always going to be the latest one model will be GPT i 4 Omni model okay and I'll be going to enclose or surround this with the this thing right this is done okay and now it will be llm right llm right okay comma Now what will happen now let's say uh I need this thing and let's say uh just because I want to actually um I want to actually pass this using stream lead response because I want to actually get a response in the Stream lead so basically just to uh just to actually compatible with the stream lead UI so I want to actually import this necessary so all these things I came to know from the documentation so pandas AI okay dot U responses right dot streamlit response okay then import uh stream l response okay and here you have to pass something called response parser so basically PA underscore parser is going to be uh stream L streamate response okay done then just because we want to actually save our plots so I have to write uh something called I want to save it actually so that is why I'm doing it so save charts okay so c h a r TS safe chart okay save charts will be true okay done it is done now what will happen save charts path so basically save c h a r TS charts uncore path okay PWD okay PWD is actually a variable that I'll be going to set here so import OS right so I want to actually get the current working directory or present working directory so os. get get CWD so basically what I'm trying to say I want to save my all the plots and plots will be Sav inside this directory only and the default uh like extension will be PNG so when whenever I'll be going to send an instruction to create a plot it will be going to save the plot in the PNG format so all initial things are done so what I'll be going to do now let me actually uh run this code and see I'm able to actually uh get some response or not okay response means uh whether I'm getting an error or not if no error it means fine right now I'm doing nothing I'm just uploading the file and converting that into a smart data frame that's it if this line is um getting executed without any error it means everything is fine right so I'll go here and I will write a stream late stream lit run then men right so basically it's happening so I'll be going to upload something from my desktop okay right so this is my desktop okay so this is the file let's upload the file file uploaded is done so no error it means everything is is working fine so what I'll do now I don't want to use this browser I want to use the Google Chrome so I'll close it and I'll be going to open this thing in my Google Chrome browser only so whenever I update the code now what will happen I'll just refresh this thing and it will work so file uploading is done right so file conversion is also done now I want I have two types of chat like one is actually uh plotting and one is actually U normal chat so what will happen so I'll be going to create a variable called options okay op TI options so options equals to chat okay and another will be flot right so now what is actually going to happen user can select this to option right you have to give the option to the user so selected underscore option okay so what will happen uh we'll be going to create a select box h. select BLX and there we'll be going to uh like ask the user to select something like like uh uh choose uh choose an option right and user will be going to choose it from this list options right all done right done now what will happen if the option is actually chat means just user wants to do chat so if right if selected option equals to equals to chat then what will happen it is going to give me the response in the UI itself in the chat format like in the text format right so we'll going to ask user a question input St do text area means if uh user is actually selecting uh chat then user should get a text area to actually write something right so I'll be going to ask here ask your question here right now if this input is not blank so if input is okay I wrote e so it will be if input is not none right so guys I'm doing it very slowly I'm explaining line by line so hopefully you guys will enjoy this video I want to just uh make a gentle pause here and I would like to request so if you're watching this video and then you came to this point please subscribe to my channel hit the like button share my videos with your family and friend this is the only way I can and get some support from all of you and I'm looking for that support So guys please help me to grow and I'll will promise I will come back always with some sort of exciting tutorials okay so like this okay so if if it is done then what will happen we'll be going to initialize a button here BTN so it will going to be St do button St do button okay and it is going to be a submit button right submit right now what will happen if button is pressed if BM then what will happen we'll be going to create a variable called response okay and we'll do uh we'll do SDF do chat SDF means what we created from here and there will be going to pass the inputs very simple and once this is done we'll be going to actually st. write the input because we already got the response from here in the form of stream LD uh stream L response actually okay so if you see here we wrote a simulate response so fine so chat part is over right so I have to actually just do it I have to do the this part now only uh like plotting part right so for plotting what is happening plotting every time it will get a file here so basically uh what you'll do uh let me do something I will just copy this part here and I will write this thing here and there I'll be just going to write else if uh no no no no sorry sorry sorry okay so basically if this is if just copy this thing here and I will just paste it here right if this is a plot right so basically if the plot is there I have to actually delete the existing plot first right so so for that I have to create I have to identify if there is any PNG file or not right so for that what is actually going to happen so we'll be going to create let's say file now file is going to be file is going to be what f is going to be glob so we have to import the glob module right so these things are basic python operation how to search a specific formatted file so glob do glob right then we have to actually search it in the present working directory right PWD and after that we have to actually mention that uh start.png like star.png any file with the PNG name now if file means if the file is uh length is greater than zero means if file is not blank basically if you do a glob it is generally going to give you a list actually with all the file names so if it is uh not n then what will happen you have to remove it so West do remove so me it means like whatever you ask from the previous question that file will be deleted right so this is deleted now w. remove is done and basically it's a least so it will be zero done right so now what will happen once the deletion is done once the deletion is done we have to ask a question same question input right and if input is not learn this this this so now everything is fine here up to this point everything is fine no problem right so once uh this thing is ready this response is generated I don't want to actually write this thing here because once the response is generated I have to again read this path okay means here so basically let's copy this thing because uh here we are doing a plotting so basically if you do this thing what will happen it is going to create a PNG file here so basically I need to find that PNG file here right so uh right if okay file and here I don't want to actually delete the file here so basically it will be now going to display the file in the streamed right so St do image right and what is actually going to be displayed so image equals to file of zero right always there will be only one PNG file right and then caption is going to be uh uh maybe I can just write plot for uh okay so plot for okay plot for like this and it will be your question only so Plus input right plot for your question right so plot for your question question means actually input right and then we'll be going to write with with equals to let's say let's give with equals to th000 one24 I don't know whether this work or not but let's see so everything is done I don't think anything is pending right so for plotting and for chatting everything is done if user is actually going to do only chat so it's only going to give the response and if it is user is going to select plot then first it will delete the existing image like let's say you already generate an image using plotting so that image will be available here so first we'll do that and after that it will generate okay so all done so hopefully I can refresh the page and I'll get the answer now right so I have created some sample question here which player has the maximum value and maximum weight so let's start with this thing total five question I'll be going to ask okay so let's refresh this thing because I need to just refresh okay it's here now what will happen I'll be just going to upload this file okay so file uploading is not done so let's see okay so sometime this drag and drop does not work so what you have to do you have to go here and you manually have to upload so see it is done 235 KB right and the the next options are ready once the file is uploaded then only these options are coming right uh choose an option right so what I'll do uh I'll say chat okay now I'll be going to I didn't ask anything so basically like this and what we'll do I'll be going to ask a question which player has the maximum value right let's do something so that is no error okay so it's doing something see here okay okay it's doing something here okay so you see the player has the maximum value is uh ealand so all you know he plays for Man City and maybe one of the like finest player of the game right now right so now it say which which player has the maximum wage okay wage means like weekly salary or something like something will come I don't know like they have a column called wage and salary uh sorry wage and value so that is I'm doing it okay so let's see how it is going to react now okay so it is saying that l l CRA Cy some police characters are there right some M so 950k Euro okay now going to ask some trick question so this two question was already done now in the chatting part let's ask one trick question so it's a very um trick question actually to see here let's see which club has the maximum player playing for them write all the players players name in simple text okay right let's see some descriptive question okay let's see whether it is able to actually generate the answer or not and if you see it is doing something here right it's doing something right okay so the club with the maximum number player is Real Madrid with the following players right so it's very amazing and they have giving the players age as well right okay so now what will happen now the fun part now let's see we'll ask some plotting okay okay so plotting we came here now what we'll do we'll be going to delete that and let's ask it to plot this thing plot bar chart bar chart with top five clubs uh with layer count in ascending order using different colors for each bar so I want to say that um Suppose there would be five clubs they are actually top with respect to player count and I want them to actually displayed in the bar chart format and they must be displayed in the ascending order and each bar should have a different color Okay so let's see and if you see here I have no PNG file here right so let's come here and execute this thing right okay and let's see whether it is doing something it started doing something and it is also started doing something here so you see it is generated here right and if you see here this is the plot it is generated right the same plot is actually displayed here right right okay now what is happen happening actually uh so we have to actually ask the next question and that time you see first it will delete Del this plot okay right this time also it is trying to delete but just because nothing is there it didn't delete anything right now it is also a little bit complex plot okay so I'm asking it to actually plot pie chart for top five classs with respect to player count okay so let's ask and let's see whether it is able to generate that or not if you see that file is deleted right now it it came so this is the file P chart came and now if I come here see so amazing right so that's it guys I would like to actually conclude the video here because or else the length of the video will be little bit uh like longer I don't want to actually uh do the same thing again and again ask the question and again but you guys can actually use this uh application for any purpose because this is a generic application you can upload any Excel file and it will do your task and also if you want to extend this thing you can extend this thing with the help of some sort of like uh uh modular code right now it's a functional have written this code you can create a modular code like you can create a like Big Tool and inside that tool you can put this uh like functionality and that will actually do your job for example um you can create a tool that uh uh smart chat application so basically there will be three option like chat with PDF chat with CSP chat with Excel right so uh chat with um anything like so it could be very amazing so I want you guys to actually try out that that project if you're not able to do it let me know I will try to do that in some weekend maybe this weekend but before that I want all of you to actually practice and um let me know have some sort of coming that how far you actually um able to go with that okay okay so the video has ended the tutorial has ended so now I have to actually end the video over here but before I go one more time I would like to request if you are new to my Channel please subscribe to my channel hit the like button share my videos as many um to as many uh like friends family like try to share actually as much as possible right and last but not least hit the hit the Bell notification so you should not miss any notification from the future and for all the existing viewers viewers please try to subscribe to my channel cuz I saw that only 5% of uh overall viewers are actually subscribing to my Channel at least whoever is watching the video and get some help please try to subscribe to my channel it is really important for me to grow because without growth U like Google or without subscriber Google will not promote like uh videos to the larger audience and it is actually very important for Google or YouTube algorithm to get picked up by the large number of audience right so please help me to grow by subscribing to my channel and as promise I'll come back again with uh some nice and exciting use Cas rent tutorial okay with that note I'm just going to conclude the video over here we'll see you in the next video till then take care goodbye have a nice day and happy learning