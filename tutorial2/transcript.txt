[Music] [Music] what's up guys this is Ronnie welcome back to our Channel Total technology Zone this is tutorial 54 and today I'll be going to show you guys how to actually use local llm or open source llm with Lang chain and obviously uh as promised I'll be going to Showcase some practical use case so in this use case what I'll do I'll just going to develop a uh crypto price board using Lang chain with open llm and I'll be going to use mistal for our open llm so from this tutorial onwards I'll just try to focus on mainly on open source llm and obviously when you are talking about open source llm uh we are not going to pay anything to open AI but the performance will be little bit graded because this uh this large language models are little bit heavy and when you are going to try it from your local computer it will be slow if you are using only CPU if you're using GPU then probably it will be little bit faster but again it depends on your computer for example right now I'm using a old version of Mac M1 it is a almost uh 2 years old computer and I am using 16 GB RAM and I don't know how much Graphics memory I have because M1 has a like um concept of actually uh Graphics memory and RAM is together so in this computer I'm getting response very fast but when I'm actually trying it from a Windows computer with a with a 4GB GPU memory or 8GB GPU memory the response is a little bit slower let's say whatever I'm getting in Mac in within 10 seconds or 20 seconds in Windows computer I'm getting it almost in 45 second or sometime it is uh giving me a response in maybe 50 seconds like that so performance is going to be impacted but again all of you are learning all of you are students so you need to actually um you want to actually uh save some money don't want to actually give some money to a company who is already making money so that is why I am I'm actually planning to create those sort of tutorials okay and also it's a very good approach to use open source llm because whenever you are going to work for some Enterprise great project so that time some companies or mainly in the startup World they generally prefer to use open source LM okay so what exactly you going to do local llm load local LM that is Mr 7B and you can actually download it from the hugging face if you go and search in Google hugging face and after that if you search for any model you will get it I'm just not going to do all those things you can just search in in the Google hugging face you will get everything okay so just to avoid um uh the view video duration uh should not be actually more than the expected time I'm just like eliminating all those like facts in this tutorial okay okay so first we'll be going to load the llm then we'll be going to develop a custom tool using langen and then we'll be going to create a function using coin cap API and get the price so basically coin cap API is a API which is actually going to give you any crypto price on the real time and after that you'll get the price I'll be going to minimize this thing so this is the API okay api. coincap iio V2 assets and Bitcoin if I just write Bitcoin it is giving you bitcoin price like like this and if you hit this thing it is going to give and all these things are actually listed on a rank wise so let's see if you want to U if you want to actually uh check ethereum price Let's uh take the ethereum okay so it is going to give me the price of ethereum okay right so maybe if I just give Doge okay so maybe Dogecoin maybe I don't know maybe yeah Dodge Coin so it is giving me Dodge okay like this okay so very cool let's start working with our code so first thing first I'm here so I have already downloaded this model so you have to make sure you are downloading ggf model okay or else it will not going to work okay so and I have okay so some file I actually need this file material txt so main. pi and llm so I'll be going to actually create a function to load our LM first okay so I'll be going to use uh what do you say uh just hold on I'll be going to use uh uh C Transformer there is a there is a utility within Lang chain this will help you to actually load any open source llm okay so how to load that so from Lang chain community. llms okay my charge is not like this just hold on I have to put my charger just give me a moment okay okay it's fine so import import C Transformer okay then I'll be just going to write def uh llm load llm I'll be going to write a function load llm and this now what will happen I'll be just going to write the code here okay so let's do it so slowly you'll be going to do everything okay so first thing uh we'll be going to create a config so C and fig config is going to be a dictionary okay so we'll mention couple of things so first thing Max new token so basically maxcore new underscore tokens so let's say I'll be going to put 1048 okay so this is going to dictionary right nextx new tokens right then what else then we'll be going to write temperature right temperature temperature I'll just make sure it is going to be 0.01 or something 0.1 okay it's a good good thing okay temperature then probably context length Okay context length let's go with a little bit bigger context so let's say 4096 okay and last important thing is actually GPU layer okay GPU layers a a y e r s okay so I'll make it 32 means all the entire model layers are actually uh going to be loaded inside the GPU okay and let's say thread d h r e ads threads is equals to minus1 okay all done okay this all these things are C Transformer documentation available if you just go to Lang Chen documentation and search for C Transformer you will get it so llm then you'll be going to write C Transformer okay and then uh everything will be same so first thing you have to write model okay so model actually will be my file path copy path I just put this like this okay then comma okay so model is done now next thing is what after model after model next thing is actually model type and the config so maybe model type what type of model I'm using I'm using mistal right so MRA and we have to pass the config right so basically Co n fig equals to C fig config all done so this is done now last thing we have to just return the llm return return llm okay that's it then that is how you'll be able to actually load any open source model with the help of lank chain okay just a little bit of extra coding but with that extra coding you can actually uh will be able to save some money okay so that's it done so I'll just going to just remember this function load LM so basically inside that first thing import llm load llm load or maybe I just going to import that from llm load import load llm so that function is loaded right all done now we'll be going to actually uh initialize couple of things more so first thing first we'll be going to get the price of the crypto so basically for that we have to write import requests request Library okay now what we'll do we just going to get the Krypto price so Dev get price we'll be going to write a function okay so it is actually going to get an input so input will be the crypto name or ID whatever and let's make it a little bit bigger okay like this so what will happen we'll be going to get the URL so URL is actually we'll get it from there okay so just copy this URL okay so this is our URL but this part is actually going to be replaced with so like this and we'll be going to actually replace input do lower so it will be always in lower case and up to this part and up to this part everything will be in double quotes okay done okay this is done now next thing is what now we'll be going to write the response so response response equals to request do get and URL okay then right so basically let's uh print the response. Json okay let's see how it is coming okay like this and let's try to actually check so basically get price and I'll be just going to send Bitcoin okay Bitcoin let's see how it is coming and should be double quotes let's see okay so basically I just need the price so this entire thing is actually comes under data so basically uh what we'll be going to do here we'll be going to Simply write price equals to response of data okay so this data is the value within data we have to get the uh our price is actually price in USD right so that's it so ly like this okay hopefully this is done right so like just delete just delete and after that we'll just return the price or maybe return return price and what I'll do I'll just going to print this function okay now this is going to give me the Bitcoin price on real time so what is this response [Music] is response object is actually not subscribable what is the problem with that I don't know what happened here okay sorry I just did a mistake it should be Json then that thing will be Json okay yes so I'm getting the price all fine let's clear this thing okay so first part is done we just created the function now what we'll be going to do uh we'll be going to actually uh create a custom tool okay so for that we'll be going to import couple of things so basically from lank chain do agents import initialize what is this initialize agent right then we'll be going to actually import from blank chain do tools import tool capital okay it is done right then I think all my things are done now you can easily create this thing so basically I don't need this thing now what we'll do we'll be just going to create a function uh a variable called API call so this API call is actually going to be uh use this tool and what I'll do I'll just going to create something like this so first thing name so basically I'm creating the tool so name of the tool will be obviously get Krypto price get get CP crypto price okay done so get crypto price is my tool name then we have to write a little bit of description but before that which function it is going to call this is going to call this get crypto price okay so get price okay and we have to write a description make sure you write a proper description or else your llm won't be able to understand okay descrip okay so I already did this tutorial with uh uh open AI but I I to check I want to check actually how this is going to work with this open source use to get the used to get the price for with the price for any given crypto from input right I think that's it uh I think that's all um input uh used to get the price for any crypto from user input from user input using I think this is fine hopefully this will work so let's see a variable tools is actually going to be API call I'll be just going to put this API call inside the tool now what we'll do I'll be just going to load the llm so our llm equals to uh this one load llm right so basically load llm uh we'll have everything right load llm and we have to call this function load llm right and then what we'll be going to do we'll be going to create the agent agent equals to initialize agent so basically it will have couple of things so first thing will be tools tools and then llm right after that agent uh equals to uh it will be agent type so basically agent type so agent type okay I just uh I actually forgot to import agent type say this something called a agent and agent type okay so agent type dot so it should be zero okay underscore short underscore react description and veros equals to true all done all done okay so last thing we have to just uh print out this model okay so maybe I can simply write print uh so agent do run or inbook whatever you want you can run it so I just write a query what is the price of Bitcoin let's see how it is actually going to give me the response okay everything is done here so basically first I created a function right then I initialize a tool within the tool I'm using the function and after that with that function I just created a variable there I'm actually using this uh tool API call in the tools variable and after that I'm passing this thing into initialize an agent so basically I'm creating a custom agent I'm using inside that Custom Tool okay and I'm us using an open source llm okay so let's execute and see how our m is actually performing okay so basically uh okay what is this module object is not callable okay so what is that let's check here uh it is saying that why this is giving this error not sure okay so C Transformer C and T is in capital so basically I don't know like why it is not capital c c Transformer so where is that trans for okay so let's do it again one more time sometime this typos are going to give error so basically it started okay it's executing in the veros mode so it's doing something let's see why this is taking time yes so yeah action get crypto price from input so I know the price of Bitcoin this right so it is able to do it okay okay so let's try to actually ask something else different so let's try to ask let's say let's go here uh not here okay so let's ask okay so just remove this thing so that we'll be able to see all the coin so e bance Solana let's ask for Solana and this is real time so for example price is USD just remember this thing okay I just refresh this thing you'll see it is going to change yeah you'll see it is so let's make it for Solana okay s s o l a n Solana okay mhm yes so get crypto price it is uh calling that tool Solana 176 from 60 8 so maybe it is like that yeah 608 okay fine so let's do it for one more thing our favorite coin Shibu okay so let's do it for Shibu okay let's see obviously it will be able to do it okay so without paying any money or without spending any dollar you are doing it okay so that's it I believe you guys are very happy with the tutorial and I got this request for a couple of months that how can we achieve this thing using open source model so there you go guys I have created this tutorial for you and you can trust me for next uh three four videos I'll be heavily going to work with uh open source llm only using um Lang CH but uh there will be only one challenge I don't know your computer configuration if you're using like um not heavily equipped computer then probably the performance are little bit degraded but again uh if you want to actually try this thing from AWS you can do it but again remember when you are going to set up some E2 instance from AWS with the GQ equipped like capabilities then also you have to pay some sort of money right so anyhow we have to actually spend whether you are going to buy a like nice laptop or computer you have to spend some money or whether you are using a simple normal laptop but every calculation if you want to actually have it on the open a side you have to spend your uh like some money from your credit card or debit card right so it's the ultimate thing like anyhow you have to spend some money right but again uh you guys requirement is now fulfilled now you guys should know how to actually work with open source llm or local llms how to load them using uh lank chain and how we can actually tackle any of the existing use case do uh with this uh open source LM right so right now I'm using M you can actually use llama 2 or maybe you can use some other models as well like Falon or Etc right so that's it for today uh before I conclude this tutorial guys uh please try to subscribe to my channel hit the like button and also you should uh press the Bell notification icon as well so that you should not miss any uh uh video updates from my any updates from my future videos okay and we'll see you in the next video till then take care goodbye and have a nice day and happy learning thank [Music] you